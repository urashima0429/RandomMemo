# Custom Computing

## ã¯ã˜ã‚ã«

### è¨ˆç®—æ©Ÿã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯
- åºƒç¾©ã«ã¯ï¼Œæ©Ÿèƒ½ï¼Œæ€§èƒ½ï¼Œã‚³ã‚¹ãƒˆè¦ä»¶ã‚’æº€ãŸã™è¨ˆç®—æ©Ÿã‚’ã©ã®ã‚ˆã†ã«æ§‹æˆã™ã‚‹ã‹
    - ä¾‹ï¼‰ã©ã®ã‚ˆã†ãªCPUï¼Œãƒ¡ãƒ¢ãƒªã‚’ä½¿ã†ã‹ï¼Œãã‚Œã‚‰ã‚’ã©ã®ã‚ˆã†ã«æ¥ç¶šã™ã‚‹ã‹
- ç‹­ç¾©ã«ã¯ï¼Œã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‹ã‚‰è¦‹ãŸãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã®æŠ½è±¡åŒ– = ISA (Instruction Set Architecture)
    - ä¾‹ï¼‰ã©ã®ã‚ˆã†ãªå‘½ä»¤ã‚»ãƒƒãƒˆã‚’æŒã¤ã‹ï¼Œã©ã®ã‚ˆã†ãªãƒ¬ã‚¸ã‚¹ã‚¿ã‚’æŒã¤ã‹

### Moore's Law
- ç´„2å¹´ã”ã¨ã«é›†ç©å›è·¯ã®é›†ç©åº¦ãŒ2å€ã«ãªã‚‹æ³•å‰‡ï¼ˆã¨ã„ã†ã‚ˆã‚Šã‹ã¯è¦³æ¸¬çµæœï¼‰
    - Apple M3 MAX (2023), TSMC 3nm, 92 billion transistors
    - NVIDIA H100 (2023), TSMS 4nm, 80 billion transistors
- ãŸã ã—è¿‘å¹´ã¯éˆåŒ–ï¼Œç‰©ç†çš„åˆ¶ç´„ã«ã‚ˆã‚Šçµ‚ç„‰ãŒè¿‘ã„

### Dennard scaling

- æ¶ˆè²»é›»åŠ›ãŒä¸€å®šã®å ´åˆï¼Œãƒˆãƒ©ãƒ³ã‚¸ã‚¹ã‚¿ã®ã‚µã‚¤ã‚ºã‚’å°ã•ãã™ã‚‹ã¨æ€§èƒ½ãŒå‘ä¸Šã™ã‚‹

$$ \text{Power} = \alpha C f V^2 + I V $$

- ã“ã“ã§
    - $\alpha$: ã‚­ãƒ£ãƒ‘ã‚·ã‚¿ã®ã‚¹ã‚¤ãƒƒãƒãƒ³ã‚°ç‡
    - $C$: ã‚­ãƒ£ãƒ‘ã‚·ã‚¿ã®å®¹é‡
    - $f$: ã‚¯ãƒ­ãƒƒã‚¯å‘¨æ³¢æ•°
    - $V$: é›»æºé›»åœ§
    - $I$: **ãƒªãƒ¼ã‚¯é›»æµ**

- ãƒˆãƒ©ãƒ³ã‚¸ã‚¹ã‚¿ã®ã‚²ãƒ¼ãƒˆå¹…ã¨é•·ã•ãŒ $\frac{1}{k}$ ã«ãªã‚‹å ´åˆã®é›»åŠ›æ¶ˆè²»ã‚’è€ƒãˆã‚‹ğŸ¤”
    - ç¬¬ä¸€é …ã¯ãƒˆãƒ¼ã‚¿ãƒ«ã§ä¸€å®šã«ãªã‚‹
        - ã‚­ãƒ£ãƒ‘ã‚·ã‚¿ã®å®¹é‡$C$ã¯ $\frac{1}{k}$ å€
        - é…å»¶ã¯ $\frac{1}{k}$ å€ => ã‚¯ãƒ­ãƒƒã‚¯å‘¨æ³¢æ•°$f$ã¯ $k$ å€
        - é›»æºé›»åœ§$V$ã¯ $\frac{1}{k}$ å€
    - ä¸€æ–¹ã§ï¼Œæ€§èƒ½ã‚’è€ƒãˆã‚‹ã¨â€¦ï¼ŸğŸ¤”
        - åŒé¢ç©å½“ãŸã‚Šã®ãƒˆãƒ©ãƒ³ã‚¸ã‚¹ã‚¿æ•°ã¯ $k^2$ å€
        - ã‚¯ãƒ­ãƒƒã‚¯å‘¨æ³¢æ•°$f$ã¯ $k$ å€
        - ã—ãŸãŒã£ã¦åŒã˜é¢ç©ãƒ»æ¶ˆè²»é›»åŠ›ã§ $k^3$ å€ã®æ€§èƒ½ãŒå¾—ã‚‰ã‚Œã‚‹
   
- ã—ã‹ã—ï¼Œãƒˆãƒ©ãƒ³ã‚¸ã‚¹ã‚¿ã®ã‚µã‚¤ã‚ºãŒå°ã•ããªã‚‹ã¨ãƒªãƒ¼ã‚¯é›»æµï¼ˆç¬¬äºŒé …ï¼‰ãŒæ”¯é…çš„ã«ãªã‚‹
- Power Wall: ã‚¯ãƒ­ãƒƒã‚¯å‘¨æ³¢æ•°ã®ä¸Šæ˜‡ã«ä¼´ã£ã¦æ¶ˆè²»é›»åŠ›ãŒå¢—åŠ ï¼ŒåŠ ãˆã¦å†·å´ã‚‚å›°é›£ã«

### Pollackâ€™s rule
- ãƒ—ãƒ­ã‚»ãƒƒã‚µã®æ€§èƒ½ã¯è¤‡é›‘ã•ã®å¹³æ–¹æ ¹ã«æ¯”ä¾‹ã™ã‚‹
    - ã‚³ã‚¢ã®è¤‡é›‘ã•ã‚’$2$å€ã«ã™ã‚‹ => ç†æƒ³çš„ã«ã¯æ€§èƒ½ã¯$\sqrt{2}$å€ã«ãªã‚‹
    - ã‚³ã‚¢ã®æ•°ã‚’$2$å€ã«ã™ã‚‹ => ç†æƒ³çš„ã«ã¯æ€§èƒ½ã¯$2$å€ã«ãªã‚‹
    - ã‚·ãƒ³ã‚°ãƒ«ã‚³ã‚¢ã‹ã‚‰ãƒãƒ«ãƒã‚³ã‚¢ã¸ã®ç§»è¡Œ

### Post-Moore's Law
- "No free lunch": ä¸‡èƒ½ãªè§£æ±ºç­–ã¯å­˜åœ¨ã—ãªã„
- ãƒˆãƒ©ãƒ³ã‚¸ã‚¹ã‚¿ã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã¯ã‚‚ã†é™ç•Œ
    - æŠ€è¡“çš„è¦å› : Lithography, Power Wall, Heat
    - çµŒæ¸ˆçš„è¦å› : fab (fabrication facility) cost
- è¦ã¯ï¼Œæ±ç”¨ãƒ»ãƒãƒ«ãƒã‚³ã‚¢ãƒ—ãƒ­ã‚»ãƒƒã‚µã®ã“ã‚Œä»¥ä¸Šã®æ€§èƒ½å‘ä¸Šã¯é›£ã—ã„

### Dark Silicon
- ãƒãƒƒãƒ—ä¸Šã§é›»åŠ›åˆ¶ç´„ã‚„ç™ºç†±å•é¡Œã®ãŸã‚ã«å‹•ä½œã•ã›ã‚‹ã“ã¨ãŒã§ããªã„é ˜åŸŸ
    - 8nmãƒ—ãƒ­ã‚»ã‚¹ã§ç´„50 - 80% [1]

### Domein-Specific Architecture (DSA)
- ç‰¹å®šã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ç‰¹åŒ–ã—ãŸå°‚ç”¨è¨ˆç®—æ©Ÿã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- åŒã˜åˆ¶ç´„ä¸‹ã§æ±ç”¨ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚ˆã‚Šã‚‚é«˜æ€§èƒ½ãªè¨ˆç®—æ©Ÿã‚’æ§‹ç¯‰å¯èƒ½
- ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»[2]: è¨ˆç®—
    - Application-aware ã«ãƒ‡ãƒ¼ã‚¿ç§»å‹•ã‚’æœ€å°åŒ–ï¼Œå†åˆ©ç”¨ã‚’æœ€å¤§åŒ–ã™ã‚‹ã“ã¨ãŒé‡è¦
- e.g., Google TPU, Preferred Network MN-Core, Cerebras WSE, GroqChip, SambaNova, etc.
- e.g., FPGA, ASIC, CGRA, etc.


### è¨ˆç®—æ©Ÿã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹
- ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ(Throughput): 1ç§’ã‚ãŸã‚Šã®å‡¦ç†é‡
    - e.g., Network bandwidth [bps], Memory bandwidth[GB/s], Floating-point operations per second [FLOPS]
- ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·(Latency): 1ã¤ã®å‡¦ç†ã«ã‹ã‹ã‚‹æ™‚é–“
    - e.g., Network latency [ms], Memory access latency [ns]
- Clock Cycle per Instruction (CPI): 1å‘½ä»¤ã‚ãŸã‚Šã®ã‚¯ãƒ­ãƒƒã‚¯ã‚µã‚¤ã‚¯ãƒ«æ•°
- Instructions per Cycle (IPC): 1ã‚¯ãƒ­ãƒƒã‚¯ã‚µã‚¤ã‚¯ãƒ«ã‚ãŸã‚Šã®å‘½ä»¤æ•°

- é›»åŠ›(power): 1ç§’ã‚ãŸã‚Šã®ä»•äº‹é‡
- é›»åŠ›é‡(Energy): 1ã¤ã®å‡¦ç†ã«ã‹ã‹ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼Œé›»åŠ›ã¨æ™‚é–“ã®ç©
- é›»åŠ›æ€§èƒ½(Power performance): ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚ãŸã‚Šæ€§èƒ½ï¼Œ**è¿‘å¹´ã¯é‡è¦è¦–ã•ã‚Œã¦ã„ã‚‹**
    - e.g., [FLOPS/W]
- ä½ã‚³ã‚¹ãƒˆ(Low-cost)
- é«˜ä¿¡é ¼æ€§(High reliability)
- ...

### Parallelisms
- ä¸¦åˆ—(parallel) $\subset$ ä¸¦è¡Œ(Concurrent)

### Flynn's taxonomy
- SISD: Single Instruction, Single Data
    - e.g., Single-core CPU
- SIMD: Single Instruction, Multiple Data
    - e.g., Vector processor, GPU
- MISD: Multiple Instruction, Single Data
    - e.g., Multi-core CPU
- MIMD: Multiple Instruction, Multiple Data
    - e.g., FPGA, CGRA

### Amdahl's Law
- ä¸¦åˆ—åŒ–ã§ããªã„éƒ¨åˆ†ã®å‰²åˆãŒæ€§èƒ½ã‚’ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã™ã‚‹

$$ T_\text{per} = T_\text{seq} \left( (1-r) + \frac{r}{N} \right) $$

- $r$: ä¸¦åˆ—åŒ–ã§ãã‚‹éƒ¨åˆ†ã®å‰²åˆ
- $N$: ä¸¦åˆ—åŒ–ã™ã‚‹ãƒ—ãƒ­ã‚»ãƒƒã‚µæ•°
- $T_\text{seq}$: é€æ¬¡å®Ÿè¡Œæ™‚é–“
- $T_\text{per}$: ä¸¦åˆ—å®Ÿè¡Œæ™‚é–“

$$ P_\text{per} = \frac{T_\text{seq}}{T_\text{per}} = \frac{1}{(1-r) + \frac{r}{N}} $$
 
 - $P_\text{per}$: ä¸¦åˆ—åŒ–åŠ¹ç‡

### Gustafson's Law
- ååˆ†ã«å¤§ããªè¦æ¨¡ã®å•é¡Œã¯ï¼ŒåŠ¹ç‡çš„ã«ä¸¦åˆ—åŒ–ã§ãã‚‹

$$ P_\text{per} = N - (1 - N) \times (1-r) $$

### Scalability
- è¨ˆç®—è³‡æºã‚’æŠ•ä¸‹ã™ã‚‹ã“ã¨ã§æ€§èƒ½ãŒã©ã‚Œã ã‘å‘ä¸Šã™ã‚‹ã‹
- Strong scaling: **å•é¡Œã‚µã‚¤ã‚ºã‚’å›ºå®šã—ã¦**è¨ˆç®—è³‡æºã‚’å¢—ã‚„ã™ã“ã¨ã«ã‚ˆã‚‹æ€§èƒ½å‘ä¸Š
- Weak scaling: **è¨ˆç®—è³‡æºã‚ãŸã‚Šã®å•é¡Œã‚µã‚¤ã‚ºã‚’å›ºå®šã—ã¦**è¨ˆç®—è³‡æºã‚’å¢—ã‚„ã™ã“ã¨ã«ã‚ˆã‚‹æ€§èƒ½å‘ä¸Š
- Scale Up: è¨ˆç®—è³‡æºã®æ€§èƒ½ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ï¼Œé«˜ã‚³ã‚¹ãƒˆ
- Scale Out: è¨ˆç®—è³‡æºã‚’å¢—ã‚„ã™ã“ã¨ï¼Œä½ã‚³ã‚¹ãƒˆ

### Memory Hierarchy
- **Memory Principle**: Small, Fast, Expensive $ \rightarrow $ Large, Slow, Cheap
    - ãƒ¬ã‚¸ã‚¹ã‚¿(æ•°KB, nsä»¥ä¸‹) 
    - $ \rightarrow $ L1ã‚­ãƒ£ãƒƒã‚·ãƒ¥(æ•°åKB, æ•°ns) 
    - $ \rightarrow $ L2ã‚­ãƒ£ãƒƒã‚·ãƒ¥(æ•°åMB, æ•°åns) 
    - ...
    - $ \rightarrow $ DRAM(æ•°åGB, æ•°ç™¾ns)
    - $ \rightarrow $ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸(æ•°TB, æ•°ms) 

### Roofline Model
- è¦–è¦šçš„ã«æ€§èƒ½ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã‚’æŠŠæ¡ã™ã‚‹ãŸã‚ã®ãƒ¢ãƒ‡ãƒ«
$$ \text{Performance} = \min \left( \text{Memory-bound}, \text{Compute-bound} \right) $$

- Xè»¸: ç®—è¡“å¼·åº¦(Arithmetic Intensity) [FLOP/Byte]
- Yè»¸: æ€§èƒ½ [FLOP/s]


## References
[1] Esmaeilzadeh, Hadi, et al. "Dark silicon and the end of multicore scaling." Proceedings of the 38th annual international symposium on Computer architecture. 2011.

[2] Horowitz, Mark. "1.1 computing's energy problem (and what we can do about it)." 2014 IEEE international solid-state circuits conference digest of technical papers (ISSCC). IEEE, 2014.